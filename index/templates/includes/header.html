<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<header class="header">
  <nav class="container">
      <div class="logo">
          <a href="{% url 'home_page' %}">RAKHIMJONOV<p>.</p></a>
      </div>
      <ul class="navbar navbar_list">
          <li><a href="{% url 'home_page' %}" class="{% if page == 'home' %}active{% endif %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="{% url 'about' %}" class="{% if page == 'about' %}active{% endif %}">–û–±–æ –º–Ω–µ</a></li>
          <li><a href="{% url 'service_list' %}" class="{% if page == 'service' %}active{% endif %}">–£—Å–ª—É–≥–∏</a></li>
          <li><a href="{% url 'project_list' %}" class="{% if page == 'projects' %}active{% endif %}">–ú–æ–∏ —Ä–∞–±–æ—Ç—ã</a></li>
      </ul>
      <div class="register_block">
          {% if user.is_authenticated %}
          <ul class="navbar_list reg_log">
            <li><a href="{% url 'feedback' %}" class="{% if page == 'feedback' %}active{% endif %}">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</a></li>
            <li>
              <form action="{% url 'logout' %}" method="post" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="logout_button">–í—ã–π—Ç–∏</button>
              </form>
            </li>
          </ul>
          {% else %}
          <ul class="navbar_list reg_log">
              <li><a href="{% url 'login' %}">–í–æ–π—Ç–∏</a></li>
              <li><a href="{% url 'register' %}">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a></li>
          </ul>
          {% endif %}
      <button id="theme-toggle" aria-pressed="false" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
          <span id="theme-icon" aria-hidden="true">üåô</span>
      </button>
      </div>
  </nav>
</header>

<script>
    // –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º –≤ IIFE, —á—Ç–æ–±—ã —Ç–æ—á–Ω–æ –∑–∞–ø—É—Å–∫–∞–ª–æ—Å—å –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ HTML
    (function () {
      const root = document.documentElement;
      const btn  = document.getElementById('theme-toggle');
      const ico  = document.getElementById('theme-icon');

      if (!btn || !ico) { console.error('–ù–µ—Ç –∫–Ω–æ–ø–∫–∏ –∏–ª–∏ –∏–∫–æ–Ω–∫–∏ —Å –Ω—É–∂–Ω—ã–º–∏ id'); return; }

      const saved = localStorage.getItem('theme');
      const systemPrefersDark = window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches;

      applyTheme(saved || (systemPrefersDark ? 'dark' : 'light'));

      btn.addEventListener('click', () => {
        const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        applyTheme(next);
      });

      function applyTheme(theme) {
        root.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        const isDark = theme === 'dark';
        btn.setAttribute('aria-pressed', isDark);
        ico.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
        btn.title = isDark ? '–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞' : '–¢—ë–º–Ω–∞—è —Ç–µ–º–∞';
      }
    })();
</script>

</body>
</html>